<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MaxBet - События и ставки</title>
    <style>
        /* ===== БАЗОВЫЕ СТИЛИ ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: #fff;
            min-height: 100vh;
        }

        .hidden {
            display: none !important;
        }

        /* ===== ШАПКА ===== */
        .header {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            color: #4fc3f7;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .balance {
            background: rgba(79, 195, 247, 0.2);
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        /* ===== НАВИГАЦИЯ ===== */
        .navigation {
            background: rgba(0, 0, 0, 0.2);
            padding: 0;
            display: flex;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .nav-tab {
            padding: 15px 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            background: rgba(255, 255, 255, 0.05);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            text-decoration: none;
            color: #fff;
        }

        .nav-tab:hover {
            background: rgba(79, 195, 247, 0.1);
        }

        .nav-tab.active {
            background: rgba(79, 195, 247, 0.2);
            border-bottom-color: #4fc3f7;
            color: #4fc3f7;
        }

        /* ===== ОСНОВНОЙ КОНТЕНТ ===== */
        .main-content {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }

        /* ===== СОБЫТИЯ ===== */
        .events-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .section-title {
            color: #4fc3f7;
            margin-bottom: 20px;
            font-size: 24px;
            font-weight: bold;
        }

        .events-filters {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: #fff;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .filter-btn:hover,
        .filter-btn.active {
            background: rgba(79, 195, 247, 0.3);
            color: #4fc3f7;
        }

        .events-grid {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .event-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .event-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .event-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .event-title {
            font-size: 18px;
            font-weight: bold;
            color: #4fc3f7;
            margin-bottom: 5px;
        }

        .event-category {
            background: rgba(79, 195, 247, 0.3);
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            white-space: nowrap;
        }

        .event-description {
            color: #b0bec5;
            margin-bottom: 20px;
            line-height: 1.4;
        }

        .event-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }

        .option-btn {
            background: linear-gradient(45deg, #4fc3f7, #29b6f6);
            border: none;
            color: #fff;
            padding: 12px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .option-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(79, 195, 247, 0.4);
        }

        .option-btn.selected {
            background: linear-gradient(45deg, #4caf50, #388e3c);
        }

        .option-text {
            font-size: 14px;
        }

        .option-coefficient {
            background: rgba(255, 255, 255, 0.2);
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
        }

        /* ===== КОРЗИНА СТАВОК ===== */
        .bet-slip-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: sticky;
            top: 20px;
            height: fit-content;
        }

        .bet-slip-empty {
            text-align: center;
            color: #b0bec5;
            padding: 40px 20px;
        }

        .bet-slip-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            position: relative;
        }

        .bet-slip-event {
            font-weight: bold;
            color: #4fc3f7;
            margin-bottom: 5px;
            font-size: 14px;
        }

        .bet-slip-option {
            color: #b0bec5;
            font-size: 13px;
        }

        .btn-remove {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #f44336;
            border: none;
            color: white;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 14px;
            line-height: 1;
        }

        .bet-slip-total {
            background: rgba(79, 195, 247, 0.2);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            text-align: center;
        }

        .total-coefficient {
            font-size: 18px;
            font-weight: bold;
            color: #4fc3f7;
        }

        .bet-slip-controls {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .bet-amount-input {
            width: 100%;
            padding: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            font-size: 14px;
        }

        .bet-amount-input:focus {
            outline: none;
            border-color: #4fc3f7;
            box-shadow: 0 0 10px rgba(79, 195, 247, 0.3);
        }

        .bet-amount-input::placeholder {
            color: #b0bec5;
        }

        .potential-win {
            text-align: center;
            color: #4caf50;
            font-weight: bold;
            margin: 10px 0;
        }

        /* ===== КНОПКИ ===== */
        .btn {
            background: linear-gradient(45deg, #4fc3f7, #29b6f6);
            border: none;
            color: #fff;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s ease;
            display: inline-block;
            text-decoration: none;
            width: 100%;
            text-align: center;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(79, 195, 247, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(45deg, #78909c, #607d8b);
        }

        .btn-success {
            background: linear-gradient(45deg, #4caf50, #388e3c);
        }

        .btn-danger {
            background: linear-gradient(45deg, #f44336, #d32f2f);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* ===== УВЕДОМЛЕНИЯ ===== */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #4fc3f7;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }

        .notification.success { background: #4caf50; }
        .notification.error { background: #f44336; }
        .notification.warning { background: #ff9800; }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* ===== ЗАГРУЗКА ===== */
        .loading {
            text-align: center;
            padding: 40px;
            color: #b0bec5;
        }

        .loading::after {
            content: "";
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid #4fc3f7;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ===== АДАПТИВНОСТЬ ===== */
        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 15px;
                padding: 15px;
            }

            .bet-slip-section {
                position: static;
            }
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 15px;
                padding: 15px;
            }

            .user-info {
                flex-direction: column;
                gap: 10px;
                align-items: stretch;
                width: 100%;
            }

            .navigation {
                flex-wrap: wrap;
            }

            .nav-tab {
                flex: 1;
                text-align: center;
                padding: 12px 15px;
                min-width: 120px;
            }

            .events-filters {
                justify-content: center;
            }

            .event-options {
                grid-template-columns: 1fr;
            }

            .main-content {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Шапка -->
    <div class="header">
        <div class="logo">🎯 MaxBet</div>
        <div class="user-info">
            <div class="balance">
                Баланс: <span id="user-balance">0 монет</span>
            </div>
            <div class="user-menu">
                <span>Привет, <span id="username">Пользователь</span>!</span>
                <button class="btn btn-secondary" onclick="logout()" style="padding: 8px 16px; width: auto;">Выйти</button>
            </div>
        </div>
    </div>

    <!-- Навигация -->
    <div class="navigation">
        <a href="main.html" class="nav-tab active">📅 События</a>
        <a href="history.html" class="nav-tab">📊 История ставок</a>
        <a href="profile.html" class="nav-tab">👤 Профиль</a>
        <a href="index.html" class="nav-tab" id="admin-link" style="display: none;">🛠️ Админ панель</a>
    </div>

    <!-- Основной контент -->
    <div class="main-content">
        <!-- Секция событий -->
        <div class="events-section">
            <h2 class="section-title">Доступные события</h2>
            
            <!-- Фильтры -->
            <div class="events-filters">
                <button class="filter-btn active" onclick="filterEvents('all')">Все</button>
                <button class="filter-btn" onclick="filterEvents('politics')">🏛️ Политика</button>
                <button class="filter-btn" onclick="filterEvents('entertainment')">🎭 Развлечения</button>
                <button class="filter-btn" onclick="filterEvents('technology')">💻 Технологии</button>
                <button class="filter-btn" onclick="filterEvents('economics')">💰 Экономика</button>
                <button class="filter-btn" onclick="filterEvents('weather')">🌤️ Погода</button>
                <button class="filter-btn" onclick="filterEvents('society')">👥 Общество</button>
            </div>

            <!-- Список событий -->
            <div id="events-container" class="events-grid">
                <div class="loading">Загрузка событий...</div>
            </div>
        </div>

        <!-- Корзина ставок -->
        <div class="bet-slip-section">
            <h3 class="section-title" style="font-size: 20px;">Корзина ставок</h3>
            <div id="bet-slip-content">
                <div class="bet-slip-empty">
                    <p>Корзина ставок пуста</p>
                    <small>Выберите события для ставки</small>
                </div>
            </div>
        </div>
    </div>

    <!-- Подключение скриптов -->
    <script src="firebase-config.js"></script>
    <script type="module">
        // ===== ИНИЦИАЛИЗАЦИЯ FIREBASE =====
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { 
            getDatabase, 
            ref as dbRef, 
            set as dbSet, 
            get as dbGet, 
            update as dbUpdate, 
            push as dbPush,
            onValue,
            off
        } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';

        // Инициализация Firebase
        const app = initializeApp(window.firebaseConfig);
        const database = getDatabase(app);

        // Экспорт функций Firebase для глобального использования
        window.database = database;
        window.dbRef = dbRef;
        window.dbSet = dbSet;
        window.dbGet = dbGet;
        window.dbUpdate = dbUpdate;
        window.dbPush = dbPush;
        window.onValue = onValue;
        window.off = off;

        // ===== ГЛОБАЛЬНЫЕ ПЕРЕМЕННЫЕ =====
        let currentUser = null;
        let events = {};
        let betSlip = [];
        let settings = {
            maxBetAmount: 1000,
            defaultBalance: 5000,
            minBetAmount: 1,
            maxCoefficient: 50
        };

        // ===== ИНИЦИАЛИЗАЦИЯ =====
        window.addEventListener('DOMContentLoaded', function() {
            checkAuth();
            loadSettings();
            loadEvents();
        });

        function checkAuth() {
            const savedUser = localStorage.getItem('currentUser');
            if (!savedUser) {
                window.location.href = 'login.html';
                return;
            }
            
            currentUser = JSON.parse(savedUser);
            updateUserInfo();
            
            // Показать админ ссылку если пользователь админ/модератор
            if (currentUser.role === 'admin' || currentUser.role === 'moderator') {
                document.getElementById('admin-link').style.display = 'block';
            }
        }

        function updateUserInfo() {
            if (!currentUser) return;
            
            document.getElementById('user-balance').textContent = `${currentUser.balance.toLocaleString()} монет`;
            document.getElementById('username').textContent = currentUser.username;
        }

        // ===== ЗАГРУЗКА НАСТРОЕК =====
        async function loadSettings() {
            try {
                const settingsRef = dbRef(database, 'settings');
                const snapshot = await dbGet(settingsRef);
                
                if (snapshot.exists()) {
                    Object.assign(settings, snapshot.val());
                }
            } catch (error) {
                console.error('Ошибка загрузки настроек:', error);
            }
        }

        // ===== ЗАГРУЗКА СОБЫТИЙ =====
        async function loadEvents() {
            try {
                const eventsRef = dbRef(database, 'events');
                const snapshot = await dbGet(eventsRef);
                
                if (snapshot.exists()) {
                    events = snapshot.val();
                } else {
                    // Создать демо события если их нет
                    await createDemoEvents();
                }
                
                displayEvents();
            } catch (error) {
                console.error('Ошибка загрузки событий:', error);
            }
        }

        async function createDemoEvents() {
            const demoEvents = {
                'demo1': {
                    title: 'Выборы президента США 2028',
                    description: 'Кто станет следующим президентом Соединенных Штатов Америки?',
                    category: 'politics',
                    options: ['Демократы', 'Республиканцы', 'Третья партия'],
                    coefficients: [1.8, 2.1, 8.5],
                    status: 'active',
                    createdAt: Date.now()
                },
                'demo2': {
                    title: 'Bitcoin достигнет $100,000',
                    description: 'Достигнет ли курс Bitcoin отметки в $100,000 до конца 2025 года?',
                    category: 'economics',
                    options: ['Да', 'Нет'],
                    coefficients: [2.5, 1.4],
                    status: 'active',
                    createdAt: Date.now()
                },
                'demo3': {
                    title: 'Новый iPhone в 2025',
                    description: 'Какая будет главная особенность нового iPhone в 2025 году?',
                    category: 'technology',
                    options: ['Складной экран', 'Holographic дисплей', 'Встроенный AI чип'],
                    coefficients: [3.2, 7.5, 2.8],
                    status: 'active',
                    createdAt: Date.now()
                }
            };

            try {
                const eventsRef = dbRef(database, 'events');
                await dbSet(eventsRef, demoEvents);
                events = demoEvents;
            } catch (error) {
                console.error('Ошибка создания демо событий:', error);
            }
        }

        function displayEvents(filter = 'all') {
            const container = document.getElementById('events-container');
            container.innerHTML = '';

            const filteredEvents = Object.entries(events).filter(([id, event]) => {
                return event.status === 'active' && (filter === 'all' || event.category === filter);
            });

            if (filteredEvents.length === 0) {
                container.innerHTML = '<div class="bet-slip-empty"><p>Нет доступных событий</p></div>';
                return;
            }

            filteredEvents.forEach(([eventId, event]) => {
                const eventElement = document.createElement('div');
                eventElement.className = 'event-card';
                eventElement.innerHTML = `
                    <div class="event-header">
                        <div>
                            <div class="event-title">${event.title}</div>
                        </div>
                        <div class="event-category">${getCategoryName(event.category)}</div>
                    </div>
                    <div class="event-description">${event.description}</div>
                    <div class="event-options">
                        ${event.options.map((option, index) => `
                            <button class="option-btn" onclick="selectOption('${eventId}', '${option}', ${event.coefficients[index]})">
                                <span class="option-text">${option}</span>
                                <span class="option-coefficient">${event.coefficients[index]}</span>
                            </button>
                        `).join('')}
                    </div>
                `;
                container.appendChild(eventElement);
            });
        }

        function getCategoryName(category) {
            const categories = {
                'politics': '🏛️ Политика',
                'entertainment': '🎭 Развлечения', 
                'technology': '💻 Технологии',
                'economics': '💰 Экономика',
                'weather': '🌤️ Погода',
                'society': '👥 Общество'
            };
            return categories[category] || category;
        }

        // ===== ФИЛЬТРАЦИЯ СОБЫТИЙ =====
        window.filterEvents = function(category) {
            // Обновить активный фильтр
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            displayEvents(category);
        };

        // ===== КОРЗИНА СТАВОК =====
        window.selectOption = function(eventId, option, coefficient) {
            if (!currentUser) {
                showNotification('Войдите в систему для размещения ставок', 'error');
                return;
            }

            const event = events[eventId];
            if (!event) return;

            // Проверить, не добавлена ли уже ставка на это событие
            const existingIndex = betSlip.findIndex(item => item.eventId === eventId);
            
            if (existingIndex !== -1) {
                // Заменить существующую ставку
                betSlip[existingIndex] = {
                    eventId: eventId,
                    eventTitle: event.title,
                    option: option,
                    coefficient: coefficient
                };
            } else {
                // Добавить новую ставку
                betSlip.push({
                    eventId: eventId,
                    eventTitle: event.title,
                    option: option,
                    coefficient: coefficient
                });
            }

            updateBetSlipDisplay();
            showNotification('Добавлено в корзину ставок', 'success');
        };

        function updateBetSlipDisplay() {
            const container = document.getElementById('bet-slip-content');
            
            if (betSlip.length === 0) {
                container.innerHTML = `
                    <div class="bet-slip-empty">
                        <p>Корзина ставок пуста</p>
                        <small>Выберите события для ставки</small>
                    </div>
                `;
                return;
            }

            const totalCoefficient = betSlip.reduce((total, bet) => total * bet.coefficient, 1);

            container.innerHTML = `
                <div class="bet-slip-items">
                    ${betSlip.map((bet, index) => `
                        <div class="bet-slip-item">
                            <button class="btn-remove" onclick="removeFromBetSlip(${index})">×</button>
                            <div class="bet-slip-event">${bet.eventTitle}</div>
                            <div class="bet-slip-option">${bet.option} (${bet.coefficient})</div>
                        </div>
                    `).join('')}
                </div>
                
                <div class="bet-slip-total">
                    <div>Общий коэффициент:</div>
                    <div class="total-coefficient">${totalCoefficient.toFixed(2)}</div>
                </div>
                
                <div class="bet-slip-controls">
                    <input type="number" 
                           class="bet-amount-input" 
                           id="bet-amount" 
                           placeholder="Сумма ставки" 
                           min="${settings.minBetAmount}" 
                           max="${Math.min(currentUser.balance, currentUser.betLimit || settings.maxBetAmount)}"
                           oninput="updatePotentialWin()">
                    
                    <div id="potential-win" class="potential-win" style="display: none;"></div>
                    
                    ${betSlip.length === 1 ? 
                        `<button class="btn" onclick="placeBet('single')">Сделать одиночную ставку</button>` : 
                        `<button class="btn" onclick="placeBet('express')">Сделать экспресс ставку</button>`
                    }
                    
                    <button class="btn btn-secondary" onclick="clearBetSlip()">Очистить корзину</button>
                </div>
            `;
        }

        window.removeFromBetSlip = function(index) {
            betSlip.splice(index, 1);
            updateBetSlipDisplay();
            showNotification('Удалено из корзины', 'warning');
        };

        window.clearBetSlip = function() {
            betSlip = [];
            updateBetSlipDisplay();
            showNotification('Корзина очищена', 'warning');
        };

        window.updatePotentialWin = function() {
            const amount = parseFloat(document.getElementById('bet-amount').value) || 0;
            const totalCoefficient = betSlip.reduce((total, bet) => total * bet.coefficient, 1);
            const potentialWin = amount * totalCoefficient;
            
            const potentialWinDiv = document.getElementById('potential-win');
            if (amount > 0) {
                potentialWinDiv.style.display = 'block';
                potentialWinDiv.textContent = `Возможный выигрыш: ${potentialWin.toFixed(2)} монет`;
            } else {
                potentialWinDiv.style.display = 'none';
            }
        };

        // ===== РАЗМЕЩЕНИЕ СТАВОК =====
        window.placeBet = async function(type) {
            if (!currentUser) {
                showNotification('Войдите в систему', 'error');
                return;
            }

            if (betSlip.length === 0) {
                showNotification('Корзина ставок пуста', 'error');
                return;
            }

            const amount = parseInt(document.getElementById('bet-amount').value);

            if (!amount || amount < settings.minBetAmount) {
                showNotification(`Минимальная ставка: ${settings.minBetAmount} монет`, 'error');
                return;
            }

            if (amount > currentUser.balance) {
                showNotification('Недостаточно средств', 'error');
                return;
            }

            if (amount > (currentUser.betLimit || settings.maxBetAmount)) {
                showNotification(`Превышен лимит ставки: ${currentUser.betLimit || settings.maxBetAmount} монет`, 'error');
                return;
            }

            try {
                let coefficient;
                let eventList;

                if (type === 'single' && betSlip.length === 1) {
                    coefficient = betSlip[0].coefficient;
                    eventList = betSlip;
                } else if (type === 'express' && betSlip.length > 1) {
                    coefficient = betSlip.reduce((total, bet) => total * bet.coefficient, 1);
                    eventList = betSlip;
                } else {
                    showNotification('Неверный тип ставки', 'error');
                    return;
                }

                // Создать ставку в базе данных
                const betsRef = dbRef(database, 'bets');
                const newBetRef = dbPush(betsRef);

                const bet = {
                    user: currentUser.username,
                    type: type,
                    amount: amount,
                    coefficient: parseFloat(coefficient.toFixed(2)),
                    status: 'pending',
                    timestamp: Date.now(),
                    events: eventList
                };

                await dbSet(newBetRef, bet);

                // Обновить баланс пользователя
                const userRef = dbRef(database, `users/${currentUser.username}`);
                const newBalance = currentUser.balance - amount;
                await dbUpdate(userRef, { balance: newBalance });

                currentUser.balance = newBalance;
                updateUserInfo();

                // Очистить корзину ставок
                betSlip = [];
                updateBetSlipDisplay();

                showNotification('Ставка размещена успешно!', 'success');

            } catch (error) {
                console.error('Ошибка размещения ставки:', error);
                showNotification('Ошибка размещения ставки', 'error');
            }
        };

        // ===== УВЕДОМЛЕНИЯ =====
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideIn 0.3s ease reverse';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // ===== ВЫХОД ИЗ СИСТЕМЫ =====
        window.logout = function() {
            localStorage.removeItem('currentUser');
            window.location.href = 'login.html';
        };

        // Экспорт для тестирования
        window.MaxBetApp = {
            currentUser,
            betSlip,
            events,
            settings
        };
    </script>
</body>
</html>
