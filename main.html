<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MaxBet - –°–æ–±—ã—Ç–∏—è –∏ —Å—Ç–∞–≤–∫–∏</title>
    <link rel="stylesheet" href="common.css">
    <link rel="stylesheet" href="main.css">

</head>
<body>
    <!-- –®–∞–ø–∫–∞ -->
    <div class="header">
        <div class="logo">üéØ MaxBet</div>
        <div class="user-info">
            <div class="balance">
                –ë–∞–ª–∞–Ω—Å: <span id="user-balance">0 –ª—É–ø–∞–Ω—á–∏–∫–æ–≤</span>
                <button id="daily-bonus-btn" class="btn" style="margin-left:10px;" onclick="openDailyBonusModal()">–ü–æ–ª—É—á–∏—Ç—å –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é –Ω–∞–≥—Ä–∞–¥—É</button>
            </div>
            <div class="user-menu">
                <span>–ü—Ä–∏–≤–µ—Ç, <span id="username">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</span>!</span>
                <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –∑–¥–µ—Å—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                <button class="btn btn-secondary" onclick="logout()" style="padding: 8px 16px; width: auto;">–í—ã–π—Ç–∏</button>
            </div>
        </div>
    </div>
    
    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <div class="navigation">
        <a href="main.html" class="nav-tab active">üìÖ –°–æ–±—ã—Ç–∏—è</a>
        <a href="history.html" class="nav-tab">üìä –ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞–≤–æ–∫</a>
        <a href="profile.html" class="nav-tab">üë§ –ü—Ä–æ—Ñ–∏–ª—å</a>
        <a href="admin.html" class="nav-tab" id="admin-link" style="display: none;">üõ†Ô∏è –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</a>
        <a href="moderator.html" class="nav-tab" id="moderator-link" style="display: none;">üõ°Ô∏è –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä</a>
    </div>
    
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <div class="main-content">
        <!-- –°–µ–∫—Ü–∏—è —Å–æ–±—ã—Ç–∏–π -->
        <div class="events-section">
            <h2 class="section-title">–î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è</h2>
            
            <!-- –§–∏–ª—å—Ç—Ä—ã -->
            <div class="events-filters">
                <button class="filter-btn active" onclick="filterEvents('all')">–í—Å–µ</button>
                <button class="filter-btn" onclick="filterEvents('politics')">üèõÔ∏è –ü–æ–ª–∏—Ç–∏–∫–∞</button>
                <button class="filter-btn" onclick="filterEvents('entertainment')">üé≠ –†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è</button>
                <button class="filter-btn" onclick="filterEvents('technology')">üíª –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</button>
                <button class="filter-btn" onclick="filterEvents('economics')">üí∞ –≠–∫–æ–Ω–æ–º–∏–∫–∞</button>
                <button class="filter-btn" onclick="filterEvents('weather')">üå§Ô∏è –ü–æ–≥–æ–¥–∞</button>
                <button class="filter-btn" onclick="filterEvents('society')">üë• –û–±—â–µ—Å—Ç–≤–æ</button>
            </div>
            
            <!-- –°–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π -->
            <div id="events-container" class="events-grid">
                <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–±—ã—Ç–∏–π...</div>
            </div>
        </div>
        
        <!-- –ö–æ—Ä–∑–∏–Ω–∞ —Å—Ç–∞–≤–æ–∫ -->
        <div class="bet-slip-section">
            <h3 class="section-title" style="font-size: 20px;">–ö–æ—Ä–∑–∏–Ω–∞ —Å—Ç–∞–≤–æ–∫</h3>
            <div id="bet-slip-content">
                <div class="bet-slip-empty">
                    <p>–ö–æ—Ä–∑–∏–Ω–∞ —Å—Ç–∞–≤–æ–∫ –ø—É—Å—Ç–∞</p>
                    <small>–í—ã–±–µ—Ä–∏—Ç–µ —Å–æ–±—ã—Ç–∏—è –¥–ª—è —Å—Ç–∞–≤–∫–∏</small>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –±–æ–Ω—É—Å–∞ -->
    <div id="dailyBonusModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeDailyBonusModal()">&times;</span>
            <h3 class="modal-title">üéÅ –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–Ω—É—Å</h3>
            <p style="color: #b0bec5; text-align: center; margin-bottom: 20px;">
                –ü–æ–ª—É—á–∞–π—Ç–µ –±–æ–Ω—É—Å—ã –∫–∞–∂–¥—ã–π –¥–µ–Ω—å! –ß–µ–º –¥–æ–ª—å—à–µ —Å–µ—Ä–∏—è, —Ç–µ–º –±–æ–ª—å—à–µ –Ω–∞–≥—Ä–∞–¥–∞.
            </p>
            <div id="bonus-calendar" class="calendar-grid">
                <!-- –ö–∞–ª–µ–Ω–¥–∞—Ä—å –±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
            <div style="text-align: center; margin-top: 20px;">
                <small style="color: #b0bec5;">
                    üí° –ó–∞—Ö–æ–¥–∏—Ç–µ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å, —á—Ç–æ–±—ã –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞—Ç—å —Å–µ—Ä–∏—é!
                </small>
            </div>
        </div>
    </div>
    
    <!-- –°–∫—Ä–∏–ø—Ç—ã -->
    <script src="firebase-config.js"></script>
    
    <!-- –°–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∂–∞–µ–º sync-manager -->
    <script type="module">
        import('./sync-manager.js').then(() => {
            console.log('‚úÖ Sync Manager –∑–∞–≥—Ä—É–∂–µ–Ω');
            
            // –ó–∞—Ç–µ–º –∑–∞–≥—Ä—É–∂–∞–µ–º main.js
            import('./main.js').then(() => {
                console.log('‚úÖ Main.js –∑–∞–≥—Ä—É–∂–µ–Ω');
            }).catch(error => {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ main.js:', error);
            });
        }).catch(error => {
            console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ sync-manager.js:', error);
            
            // –ü—ã—Ç–∞–µ–º—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å main.js –±–µ–∑ sync manager
            import('./main.js').then(() => {
                console.log('‚ö†Ô∏è Main.js –∑–∞–≥—Ä—É–∂–µ–Ω –±–µ–∑ sync manager');
            }).catch(mainError => {
                console.error('‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ main.js:', mainError);
            });
        });
    </script>
    
    <!-- –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
    <script>
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (–¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –∫–æ–Ω—Å–æ–ª–∏)
        window.testSync = function() {
            if (window.dataSyncManager) {
                console.log('üîÑ –°—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:', window.dataSyncManager.getSyncStatus());
                console.log('üë§ –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:', window.dataSyncManager.getCurrentUser());
                console.log('üì§ –û—Ç–ª–æ–∂–µ–Ω–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π:', window.dataSyncManager.getPendingUpdatesCount());
            } else {
                console.log('‚ùå DataSyncManager –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω');
            }
        };
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
        window.forceSync = function() {
            if (window.dataSyncManager) {
                window.dataSyncManager.forceRefresh()
                    .then(() => console.log('‚úÖ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞'))
                    .catch(error => console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:', error));
            } else {
                console.log('‚ùå DataSyncManager –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω');
            }
        };
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        window.clearData = function() {
            if (window.dataSyncManager) {
                window.dataSyncManager.clearLocalData();
                console.log('üóëÔ∏è –õ–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã');
            }
            localStorage.clear();
            location.reload();
        };
        
        // –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', function() {
            console.log('üéØ Main.html –∑–∞–≥—Ä—É–∂–µ–Ω');
            console.log('üîß Firebase config –¥–æ—Å—Ç—É–ø–µ–Ω:', !!window.firebaseConfig);
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –≤ development —Ä–µ–∂–∏–º–µ
            if (location.hostname === 'localhost' || location.hostname === '127.0.0.1') {
                console.log('üõ†Ô∏è –û—Ç–ª–∞–¥–æ—á–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:');
                console.log('   testSync() - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏');
                console.log('   forceSync() - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å');
                console.log('   clearData() - –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ');
            }
        });
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
        window.addEventListener('error', function(e) {
            console.error('üö® JavaScript –æ—à–∏–±–∫–∞ –≤ main.html:', e.error);
            console.error('üìç –§–∞–π–ª:', e.filename, '–°—Ç—Ä–æ–∫–∞:', e.lineno);
        });
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ Promise –æ—à–∏–±–æ–∫
        window.addEventListener('unhandledrejection', function(e) {
            console.error('üö® –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è Promise –æ—à–∏–±–∫–∞:', e.reason);
            e.preventDefault();
        });
    </script>
</body>
</html>
