<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MaxBet - –°–æ–±—ã—Ç–∏—è –∏ —Å—Ç–∞–≤–∫–∏</title>
    <link rel="stylesheet" href="common.css">
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <!-- –®–∞–ø–∫–∞ -->
    <div class="header">
        <div class="logo">üéØ MaxBet</div>
        <div class="user-info">
            <div class="balance">
                –ë–∞–ª–∞–Ω—Å: <span id="user-balance">0 –ª—É–ø–∞–Ω—á–∏–∫–æ–≤</span>
                <button id="daily-bonus-btn" class="btn" style="margin-left:10px;" onclick="openDailyBonusModal()">–ü–æ–ª—É—á–∏—Ç—å –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é –Ω–∞–≥—Ä–∞–¥—É</button>
            </div>
            <div class="user-menu">
                <span>–ü—Ä–∏–≤–µ—Ç, <span id="username">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</span>!</span>
                <div id="connection-status" class="sync-indicator online" style="margin-left: 10px; padding: 4px 8px; border-radius: 12px; font-size: 12px;">
                    üü¢ –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ
                </div>
                <button class="btn btn-secondary" onclick="logout()" style="padding: 8px 16px; width: auto;">–í—ã–π—Ç–∏</button>
            </div>
        </div>
    </div>
    
    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <div class="navigation">
        <a href="main.html" class="nav-tab active">üìÖ –°–æ–±—ã—Ç–∏—è</a>
        <a href="history.html" class="nav-tab">üìä –ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞–≤–æ–∫</a>
        <a href="profile.html" class="nav-tab">üë§ –ü—Ä–æ—Ñ–∏–ª—å</a>
        <a href="admin.html" class="nav-tab" id="admin-link" style="display: none;">üõ†Ô∏è –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</a>
        <a href="moderator.html" class="nav-tab" id="moderator-link" style="display: none;">üõ°Ô∏è –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä</a>
    </div>
    
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <div class="main-content">
        <!-- –°–µ–∫—Ü–∏—è —Å–æ–±—ã—Ç–∏–π -->
        <div class="events-section">
            <h2 class="section-title">–î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è</h2>
            
            <!-- –§–∏–ª—å—Ç—Ä—ã -->
            <div class="events-filters">
                <button class="filter-btn active" onclick="filterEvents('all')">–í—Å–µ</button>
                <button class="filter-btn" onclick="filterEvents('politics')">üèõÔ∏è –ü–æ–ª–∏—Ç–∏–∫–∞</button>
                <button class="filter-btn" onclick="filterEvents('entertainment')">üé≠ –†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è</button>
                <button class="filter-btn" onclick="filterEvents('technology')">üíª –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</button>
                <button class="filter-btn" onclick="filterEvents('economics')">üí∞ –≠–∫–æ–Ω–æ–º–∏–∫–∞</button>
                <button class="filter-btn" onclick="filterEvents('weather')">üå§Ô∏è –ü–æ–≥–æ–¥–∞</button>
                <button class="filter-btn" onclick="filterEvents('society')">üë• –û–±—â–µ—Å—Ç–≤–æ</button>
            </div>
            
            <!-- –°–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π -->
            <div id="events-container" class="events-grid">
                <div class="loading">üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–±—ã—Ç–∏–π...</div>
            </div>
        </div>
        
        <!-- –ö–æ—Ä–∑–∏–Ω–∞ —Å—Ç–∞–≤–æ–∫ -->
        <div class="bet-slip-section">
            <h3 class="section-title" style="font-size: 20px;">–ö–æ—Ä–∑–∏–Ω–∞ —Å—Ç–∞–≤–æ–∫</h3>
            <div id="bet-slip-content">
                <div class="bet-slip-empty">
                    <p>–ö–æ—Ä–∑–∏–Ω–∞ —Å—Ç–∞–≤–æ–∫ –ø—É—Å—Ç–∞</p>
                    <small>–í—ã–±–µ—Ä–∏—Ç–µ —Å–æ–±—ã—Ç–∏—è –¥–ª—è —Å—Ç–∞–≤–∫–∏</small>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –±–æ–Ω—É—Å–∞ -->
    <div id="dailyBonusModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeDailyBonusModal()">&times;</span>
            <h3 class="modal-title">üéÅ –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–Ω—É—Å</h3>
            <p style="color: #b0bec5; text-align: center; margin-bottom: 20px;">
                –ü–æ–ª—É—á–∞–π—Ç–µ –±–æ–Ω—É—Å—ã –∫–∞–∂–¥—ã–π –¥–µ–Ω—å! –ß–µ–º –¥–æ–ª—å—à–µ —Å–µ—Ä–∏—è, —Ç–µ–º –±–æ–ª—å—à–µ –Ω–∞–≥—Ä–∞–¥–∞.
            </p>
            <div id="bonus-calendar" class="calendar-grid">
                <!-- –ö–∞–ª–µ–Ω–¥–∞—Ä—å –±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
            <div style="text-align: center; margin-top: 20px;">
                <small style="color: #b0bec5;">
                    üí° –ó–∞—Ö–æ–¥–∏—Ç–µ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å, —á—Ç–æ–±—ã –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞—Ç—å —Å–µ—Ä–∏—é!
                </small>
            </div>
        </div>
    </div>
    
    <!-- –ó–∞–≥—Ä—É–∑–∫–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤ -->
    <script src="firebase-config.js"></script>
    <script type="module" src="main.js"></script>
    
    <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã -->
    <script>
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
        function updateConnectionStatus() {
            const statusDiv = document.getElementById('connection-status');
            if (!statusDiv) return;
            
            if (navigator.onLine) {
                statusDiv.className = 'sync-indicator online';
                statusDiv.innerHTML = 'üü¢ –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ';
            } else {
                statusDiv.className = 'sync-indicator offline';
                statusDiv.innerHTML = 'üî¥ –ù–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è';
            }
        }
        
        // –°–ª—É—à–∞—Ç–µ–ª–∏ —Å–æ–±—ã—Ç–∏–π —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
        window.addEventListener('online', () => {
            updateConnectionStatus();
            console.log('üåê –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ');
        });
        
        window.addEventListener('offline', () => {
            updateConnectionStatus();
            console.log('üì° –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä—è–Ω–æ');
        });
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', () => {
            updateConnectionStatus();
            console.log('üéØ Main.html –∑–∞–≥—Ä—É–∂–µ–Ω');
            console.log('üîß Firebase config –¥–æ—Å—Ç—É–ø–µ–Ω:', !!window.firebaseConfig);
        });
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        window.testConnection = function() {
            console.log('üß™ –¢–µ—Å—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è:', navigator.onLine ? 'Online' : 'Offline');
            updateConnectionStatus();
        };
        
        window.reloadEvents = function() {
            if (window.loadEvents) {
                window.loadEvents();
            } else {
                console.log('‚ö†Ô∏è –§—É–Ω–∫—Ü–∏—è loadEvents –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞');
            }
        };
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ JavaScript
        window.addEventListener('error', function(e) {
            console.error('üö® JavaScript –æ—à–∏–±–∫–∞ –≤ main.html:', e.error);
            console.error('üìç –§–∞–π–ª:', e.filename, '–°—Ç—Ä–æ–∫–∞:', e.lineno);
        });
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ Promise –æ—à–∏–±–æ–∫
        window.addEventListener('unhandledrejection', function(e) {
            console.error('üö® –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è Promise –æ—à–∏–±–∫–∞:', e.reason);
            e.preventDefault();
        });
        
        // –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –≤ development —Ä–µ–∂–∏–º–µ
        if (location.hostname === 'localhost' || location.hostname === '127.0.0.1') {
            setTimeout(() => {
                console.log('üõ†Ô∏è –û—Ç–ª–∞–¥–æ—á–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:');
                console.log('   testConnection() - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ');
                console.log('   reloadEvents() - –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ–±—ã—Ç–∏—è');
                console.log('   loadEvents() - –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ–±—ã—Ç–∏—è –∑–∞–Ω–æ–≤–æ');
            }, 2000);
        }
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø–æ –∫–ª–∏–∫—É –Ω–∞ —Ñ–æ–Ω
        window.addEventListener('click', function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        });
        
        // –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
        setInterval(updateConnectionStatus, 30000);
    </script>
</body>
</html>
