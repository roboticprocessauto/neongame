<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MaxBet - –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</title>
    <style>
        /* ===== –ë–ê–ó–û–í–´–ï –°–¢–ò–õ–ò ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: #fff;
            min-height: 100vh;
        }

        .hidden {
            display: none !important;
        }

        /* ===== –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨ ===== */
        .admin-panel {
            background: rgba(255, 255, 255, 0.05);
            margin: 20px;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow: hidden;
        }

        .admin-header {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .admin-title {
            color: #4fc3f7;
            margin-bottom: 0;
            font-size: 24px;
        }

        /* ===== –í–ö–õ–ê–î–ö–ò ===== */
        .admin-tabs {
            display: flex;
            background: rgba(0, 0, 0, 0.2);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .admin-tab {
            padding: 15px 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            background: rgba(255, 255, 255, 0.05);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
        }

        .admin-tab:hover {
            background: rgba(79, 195, 247, 0.1);
        }

        .admin-tab.active {
            background: rgba(79, 195, 247, 0.2);
            border-bottom-color: #4fc3f7;
            color: #4fc3f7;
        }

        .admin-tab-content {
            padding: 25px;
            min-height: 600px;
        }

        /* ===== –§–û–†–ú–´ –ò –ò–ù–ü–£–¢–´ ===== */
        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #fff;
            font-weight: 500;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #4fc3f7;
            box-shadow: 0 0 10px rgba(79, 195, 247, 0.3);
        }

        .form-group input::placeholder,
        .form-group textarea::placeholder {
            color: #b0bec5;
        }

        /* ===== –ö–ù–û–ü–ö–ò ===== */
        .btn {
            background: linear-gradient(45deg, #4fc3f7, #29b6f6);
            border: none;
            color: #fff;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s ease;
            display: inline-block;
            text-decoration: none;
            margin-right: 10px;
            margin-bottom: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(79, 195, 247, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(45deg, #78909c, #607d8b);
        }

        .btn-warning {
            background: linear-gradient(45deg, #ff9800, #f57c00);
        }

        .btn-danger {
            background: linear-gradient(45deg, #f44336, #d32f2f);
        }

        .btn-success {
            background: linear-gradient(45deg, #4caf50, #388e3c);
        }

        /* ===== –¢–ê–ë–õ–ò–¶–´ ===== */
        .admin-table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .admin-table th,
        .admin-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .admin-table th {
            background: rgba(79, 195, 247, 0.2);
            font-weight: bold;
            color: #4fc3f7;
        }

        .admin-table tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        /* ===== –ö–ê–†–¢–û–ß–ö–ò ===== */
        .admin-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .admin-card h4 {
            color: #4fc3f7;
            margin-bottom: 15px;
        }

        /* ===== –°–¢–ê–¢–ò–°–¢–ò–ö–ê ===== */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .stat-number {
            font-size: 32px;
            font-weight: bold;
            color: #4fc3f7;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #b0bec5;
            font-size: 14px;
        }

        /* ===== –§–ò–õ–¨–¢–†–´ ===== */
        .filters {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            align-items: center;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .filter-group label {
            font-size: 12px;
            color: #b0bec5;
        }

        .filter-group select,
        .filter-group input {
            padding: 8px 12px;
            border-radius: 6px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            font-size: 14px;
        }

        /* ===== –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê ===== */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 1000;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            border-radius: 15px;
            padding: 30px;
            min-width: 500px;
            max-width: 90vw;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .modal-title {
            margin-bottom: 20px;
            color: #4fc3f7;
        }

        .close {
            float: right;
            font-size: 28px;
            cursor: pointer;
            color: #b0bec5;
            transition: color 0.3s ease;
        }

        .close:hover {
            color: #fff;
        }

        /* ===== –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ ===== */
        @media (max-width: 768px) {
            .admin-tabs {
                flex-wrap: wrap;
            }

            .admin-tab {
                flex: 1;
                min-width: 120px;
                text-align: center;
                padding: 12px 15px;
            }

            .modal-content {
                min-width: 300px;
                margin: 20px;
            }

            .filters {
                flex-direction: column;
                align-items: stretch;
            }

            .stats-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        /* ===== –ó–ê–ì–†–£–ó–ö–ê ===== */
        .loading {
            text-align: center;
            padding: 40px;
            color: #b0bec5;
        }

        .loading::after {
            content: "";
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid #4fc3f7;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ===== –°–¢–ê–¢–£–°–´ ===== */
        .status-active { color: #4caf50; font-weight: bold; }
        .status-inactive { color: #f44336; font-weight: bold; }
        .status-pending { color: #ff9800; font-weight: bold; }
        .status-won { color: #4caf50; font-weight: bold; }
        .status-lost { color: #f44336; font-weight: bold; }

        .role-admin { color: #f44336; font-weight: bold; }
        .role-moderator { color: #ff9800; font-weight: bold; }
        .role-user { color: #b0bec5; }
    </style>
</head>
<body>
    <div class="admin-panel">
        <div class="admin-header">
            <h2 class="admin-title">üõ†Ô∏è –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ MaxBet</h2>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∏ -->
        <div class="admin-tabs">
            <div class="admin-tab active" onclick="switchTab('events')">üìÖ –°–æ–±—ã—Ç–∏—è</div>
            <div class="admin-tab" onclick="switchTab('users')">üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</div>
            <div class="admin-tab" onclick="switchTab('bets')">üéØ –°—Ç–∞–≤–∫–∏</div>
            <div class="admin-tab" onclick="switchTab('settings')">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
            <div class="admin-tab" onclick="switchTab('stats')">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>
        </div>

        <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª–∞–¥–æ–∫ -->
        
        <!-- –í–ö–õ–ê–î–ö–ê: –°–û–ë–´–¢–ò–Ø -->
        <div id="tab-events" class="admin-tab-content">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                <!-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è -->
                <div class="admin-card">
                    <h4>–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ</h4>
                    <div class="form-group">
                        <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</label>
                        <select id="eventCategory">
                            <option value="politics">üèõÔ∏è –ü–æ–ª–∏—Ç–∏–∫–∞</option>
                            <option value="entertainment">üé≠ –†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è</option>
                            <option value="technology">üíª –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</option>
                            <option value="economics">üí∞ –≠–∫–æ–Ω–æ–º–∏–∫–∞</option>
                            <option value="weather">üå§Ô∏è –ü–æ–≥–æ–¥–∞</option>
                            <option value="society">üë• –û–±—â–µ—Å—Ç–≤–æ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>–ù–∞–∑–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è:</label>
                        <input type="text" id="eventTitle" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –í—ã–±–æ—Ä—ã –ø—Ä–µ–∑–∏–¥–µ–Ω—Ç–∞ 2025">
                    </div>
                    <div class="form-group">
                        <label>–û–ø–∏—Å–∞–Ω–∏–µ:</label>
                        <textarea id="eventDescription" placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label>–í–∞—Ä–∏–∞–Ω—Ç—ã (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é):</label>
                        <input type="text" id="eventOptions" placeholder="–î–∞, –ù–µ—Ç, –í–æ–∑–º–æ–∂–Ω–æ">
                    </div>
                    <div class="form-group">
                        <label>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é):</label>
                        <input type="text" id="eventCoefficients" placeholder="1.5, 2.0, 3.2">
                    </div>
                    <button class="btn" onclick="addEvent()">–î–æ–±–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ</button>
                </div>

                <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è–º–∏ -->
                <div class="admin-card">
                    <h4>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è–º–∏</h4>
                    <div style="margin-bottom: 15px;">
                        <button class="btn btn-secondary" onclick="loadUnfinishedEvents()">–ü–æ–∫–∞–∑–∞—Ç—å –Ω–µ–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ</button>
                        <button class="btn btn-warning" onclick="fixEventsCategories()">–ò—Å–ø—Ä–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</button>
                        <button class="btn" onclick="loadAdminEvents()">–û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫</button>
                    </div>
                    <div id="adminEventsList" style="max-height: 400px; overflow-y: auto;"></div>
                </div>
            </div>
        </div>

        <!-- –í–ö–õ–ê–î–ö–ê: –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ò -->
        <div id="tab-users" class="admin-tab-content hidden">
            <div class="admin-card">
                <h4>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h4>
                
                <!-- –§–∏–ª—å—Ç—Ä—ã -->
                <div class="filters">
                    <div class="filter-group">
                        <label>–†–æ–ª—å:</label>
                        <select id="userRoleFilter" onchange="filterUsers()">
                            <option value="all">–í—Å–µ —Ä–æ–ª–∏</option>
                            <option value="admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã</option>
                            <option value="moderator">–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä—ã</option>
                            <option value="user">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>–ü–æ–∏—Å–∫:</label>
                        <input type="text" id="userSearchFilter" placeholder="–ü–æ–∏—Å–∫ –ø–æ –ª–æ–≥–∏–Ω—É" oninput="filterUsers()">
                    </div>
                    <button class="btn" onclick="loadUsers()">–û–±–Ω–æ–≤–∏—Ç—å</button>
                    <button class="btn btn-success" onclick="showAddUserModal()">–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
                </div>

                <!-- –¢–∞–±–ª–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
                <table class="admin-table" id="usersTable">
                    <thead>
                        <tr>
                            <th>–õ–æ–≥–∏–Ω</th>
                            <th>–†–æ–ª—å</th>
                            <th>–ë–∞–ª–∞–Ω—Å</th>
                            <th>–õ–∏–º–∏—Ç —Å—Ç–∞–≤–∫–∏</th>
                            <th>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</th>
                            <th>–°—Ç–∞—Ç—É—Å</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="usersTableBody">
                        <tr><td colspan="7" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- –í–ö–õ–ê–î–ö–ê: –°–¢–ê–í–ö–ò -->
        <div id="tab-bets" class="admin-tab-content hidden">
            <div class="admin-card">
                <h4>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞–≤–∫–∞–º–∏</h4>
                
                <!-- –§–∏–ª—å—Ç—Ä—ã -->
                <div class="filters">
                    <div class="filter-group">
                        <label>–°—Ç–∞—Ç—É—Å:</label>
                        <select id="betStatusFilter" onchange="filterBets()">
                            <option value="all">–í—Å–µ —Å—Ç–∞–≤–∫–∏</option>
                            <option value="pending">–û–∂–∏–¥–∞—é—Ç</option>
                            <option value="won">–í—ã–∏–≥—Ä–∞–ª–∏</option>
                            <option value="lost">–ü—Ä–æ–∏–≥—Ä–∞–ª–∏</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>–¢–∏–ø:</label>
                        <select id="betTypeFilter" onchange="filterBets()">
                            <option value="all">–í—Å–µ —Ç–∏–ø—ã</option>
                            <option value="single">–û–¥–∏–Ω–æ—á–Ω—ã–µ</option>
                            <option value="express">–≠–∫—Å–ø—Ä–µ—Å—Å—ã</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:</label>
                        <input type="text" id="betUserFilter" placeholder="–õ–æ–≥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" oninput="filterBets()">
                    </div>
                    <button class="btn" onclick="loadBets()">–û–±–Ω–æ–≤–∏—Ç—å</button>
                </div>

                <!-- –¢–∞–±–ª–∏—Ü–∞ —Å—Ç–∞–≤–æ–∫ -->
                <table class="admin-table" id="betsTable">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
                            <th>–¢–∏–ø</th>
                            <th>–°—É–º–º–∞</th>
                            <th>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç</th>
                            <th>–í–æ–∑–º–æ–∂–Ω—ã–π –≤—ã–∏–≥—Ä—ã—à</th>
                            <th>–°—Ç–∞—Ç—É—Å</th>
                            <th>–î–∞—Ç–∞</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="betsTableBody">
                        <tr><td colspan="9" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞–≤–æ–∫...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- –í–ö–õ–ê–î–ö–ê: –ù–ê–°–¢–†–û–ô–ö–ò -->
        <div id="tab-settings" class="admin-tab-content hidden">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                <!-- –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ -->
                <div class="admin-card">
                    <h4>–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h4>
                    <div class="form-group">
                        <label>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞ (–º–æ–Ω–µ—Ç—ã):</label>
                        <input type="number" id="maxBetAmount" min="1" max="100000">
                    </div>
                    <div class="form-group">
                        <label>–°—Ç–∞—Ä—Ç–æ–≤—ã–π –±–∞–ª–∞–Ω—Å –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</label>
                        <input type="number" id="defaultBalance" min="100" max="100000">
                    </div>
                    <div class="form-group">
                        <label>–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞ (–º–æ–Ω–µ—Ç—ã):</label>
                        <input type="number" id="minBetAmount" min="1" max="1000">
                    </div>
                    <div class="form-group">
                        <label>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç:</label>
                        <input type="number" id="maxCoefficient" step="0.1" min="1" max="100">
                    </div>
                    <button class="btn" onclick="saveSettings()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                </div>

                <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–º–∏—Å—Å–∏–π -->
                <div class="admin-card">
                    <h4>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–º–∏—Å—Å–∏–π</h4>
                    <div class="form-group">
                        <label>–ö–æ–º–∏—Å—Å–∏—è —Å –≤—ã–∏–≥—Ä—ã—à–µ–π (%):</label>
                        <input type="number" id="winCommission" step="0.1" min="0" max="50">
                    </div>
                    <div class="form-group">
                        <label>–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –≤—ã–≤–æ–¥–∞:</label>
                        <input type="number" id="minWithdraw" min="1" max="10000">
                    </div>
                    <div class="form-group">
                        <label>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –≤—ã–≤–æ–¥–∞ –≤ –¥–µ–Ω—å:</label>
                        <input type="number" id="maxWithdrawPerDay" min="100" max="1000000">
                    </div>
                    <button class="btn" onclick="saveCommissionSettings()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>

                <!-- –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ -->
                <div class="admin-card">
                    <h4>–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ</h4>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="maintenanceMode"> –†–µ–∂–∏–º —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è
                        </label>
                    </div>
                    <div class="form-group">
                        <label>–°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</label>
                        <textarea id="maintenanceMessage" rows="3" placeholder="–°–∞–π—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω..."></textarea>
                    </div>
                    <button class="btn btn-warning" onclick="toggleMaintenance()">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
                </div>

                <!-- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö -->
                <div class="admin-card">
                    <h4>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏</h4>
                    <button class="btn btn-secondary" onclick="exportData()">–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</button>
                    <button class="btn btn-warning" onclick="cleanOldBets()">–û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ —Å—Ç–∞–≤–∫–∏</button>
                    <button class="btn btn-danger" onclick="resetAllBalances()">–°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –±–∞–ª–∞–Ω—Å—ã</button>
                    <br><br>
                    <small style="color: #b0bec5;">‚ö†Ô∏è –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –Ω–µ–æ–±—Ä–∞—Ç–∏–º—ã!</small>
                </div>
            </div>
        </div>

        <!-- –í–ö–õ–ê–î–ö–ê: –°–¢–ê–¢–ò–°–¢–ò–ö–ê -->
        <div id="tab-stats" class="admin-tab-content hidden">
            <!-- –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="totalUsers">0</div>
                    <div class="stat-label">–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalBets">0</div>
                    <div class="stat-label">–í—Å–µ–≥–æ —Å—Ç–∞–≤–æ–∫</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalVolume">0</div>
                    <div class="stat-label">–û–±—â–∏–π –æ–±–æ—Ä–æ—Ç</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="activeEvents">0</div>
                    <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalBalance">0</div>
                    <div class="stat-label">–û–±—â–∏–π –±–∞–ª–∞–Ω—Å –∏–≥—Ä–æ–∫–æ–≤</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="pendingBets">0</div>
                    <div class="stat-label">–°—Ç–∞–≤–æ–∫ –≤ –æ–∂–∏–¥–∞–Ω–∏–∏</div>
                </div>
            </div>

            <!-- –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                <div class="admin-card">
                    <h4>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</h4>
                    <div id="categoryStats"></div>
                </div>
                <div class="admin-card">
                    <h4>–¢–æ–ø –∏–≥—Ä–æ–∫–∏ –ø–æ –æ–±–æ—Äotu</h4>
                    <div id="topPlayers"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê -->
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
    <div id="addUserModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('addUserModal')">&times;</span>
            <h3 class="modal-title">–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
            <div class="form-group">
                <label>–õ–æ–≥–∏–Ω:</label>
                <input type="text" id="newUserLogin" placeholder="–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω">
            </div>
            <div class="form-group">
                <label>–ü–∞—Ä–æ–ª—å:</label>
                <input type="password" id="newUserPassword" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
            </div>
            <div class="form-group">
                <label>–†–æ–ª—å:</label>
                <select id="newUserRole">
                    <option value="user">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</option>
                    <option value="moderator">–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä</option>
                    <option value="admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
                </select>
            </div>
            <div class="form-group">
                <label>–ù–∞—á–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å:</label>
                <input type="number" id="newUserBalance" value="5000" min="0">
            </div>
            <div style="text-align: right;">
                <button class="btn btn-secondary" onclick="closeModal('addUserModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn" onclick="addUser()">–î–æ–±–∞–≤–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
    <div id="editUserModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('editUserModal')">&times;</span>
            <h3 class="modal-title">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
            <input type="hidden" id="editUserLogin">
            <div class="form-group">
                <label>–õ–æ–≥–∏–Ω:</label>
                <input type="text" id="editUserLoginDisplay" disabled>
            </div>
            <div class="form-group">
                <label>–†–æ–ª—å:</label>
                <select id="editUserRole">
                    <option value="user">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</option>
                    <option value="moderator">–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä</option>
                    <option value="admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
                </select>
            </div>
            <div class="form-group">
                <label>–ë–∞–ª–∞–Ω—Å:</label>
                <input type="number" id="editUserBalance" min="0">
            </div>
            <div class="form-group">
                <label>–õ–∏–º–∏—Ç —Å—Ç–∞–≤–∫–∏:</label>
                <input type="number" id="editUserBetLimit" min="1">
            </div>
            <div class="form-group">
                <label>–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å (–æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º, –µ—Å–ª–∏ –Ω–µ —Ö–æ—Ç–∏—Ç–µ –º–µ–Ω—è—Ç—å):</label>
                <input type="password" id="editUserPassword" placeholder="–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å">
            </div>
            <div style="text-align: right;">
                <button class="btn btn-secondary" onclick="closeModal('editUserModal')">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn" onclick="updateUser()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å—Ç–∞–≤–∫–∏ -->
    <div id="viewBetModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('viewBetModal')">&times;</span>
            <h3 class="modal-title">–î–µ—Ç–∞–ª–∏ —Å—Ç–∞–≤–∫–∏</h3>
            <div id="betDetails"></div>
            <div style="text-align: right; margin-top: 20px;">
                <button class="btn btn-secondary" onclick="closeModal('viewBetModal')">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <script>
        // ===== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï =====
        let currentTab = 'events';
        let allUsers = {};
        let allBets = {};
        let allEvents = {};
        let settings = {
            maxBetAmount: 1000,
            defaultBalance: 5000,
            minBetAmount: 1,
            maxCoefficient: 50,
            winCommission: 5,
            minWithdraw: 100,
            maxWithdrawPerDay: 50000,
            maintenanceMode: false,
            maintenanceMessage: ''
        };

        // ===== –£–ü–†–ê–í–õ–ï–ù–ò–ï –í–ö–õ–ê–î–ö–ê–ú–ò =====
        function switchTab(tabName) {
            // –°–∫—Ä—ã—Ç—å –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
            document.querySelectorAll('.admin-tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });
            
            // –£–±—Ä–∞—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
            document.getElementById(`tab-${tabName}`).classList.remove('hidden');
            event.target.classList.add('active');
            
            currentTab = tabName;
            
            // –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤–∫–ª–∞–¥–∫–∏
            switch(tabName) {
                case 'users':
                    loadUsers();
                    break;
                case 'bets':
                    loadBets();
                    break;
                case 'settings':
                    loadSettings();
                    break;
                case 'stats':
                    loadStatistics();
                    break;
                case 'events':
                    loadAdminEvents();
                    break;
            }
        }

        // ===== –£–ü–†–ê–í–õ–ï–ù–ò–ï –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø–ú–ò =====
        async function loadUsers() {
            try {
                // –ò–º–∏—Ç–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
                const tbody = document.getElementById('usersTableBody');
                tbody.innerHTML = '<tr><td colspan="7" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...</td></tr>';
                
                // –°–∏–º—É–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                setTimeout(() => {
                    allUsers = {
                        'admin': {
                            password: 'admin123',
                            role: 'admin',
                            balance: 50000,
                            betLimit: 10000,
                            registeredAt: Date.now() - 30 * 24 * 60 * 60 * 1000,
                            status: 'active'
                        },
                        'user1': {
                            password: 'user123',
                            role: 'user',
                            balance: 2500,
                            betLimit: 1000,
                            registeredAt: Date.now() - 15 * 24 * 60 * 60 * 1000,
                            status: 'active'
                        },
                        'moderator1': {
                            password: 'mod123',
                            role: 'moderator',
                            balance: 10000,
                            betLimit: 5000,
                            registeredAt: Date.now() - 7 * 24 * 60 * 60 * 1000,
                            status: 'active'
                        }
                    };
                    
                    displayUsers();
                }, 1000);
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:', error);
            }
        }

        function displayUsers() {
            const tbody = document.getElementById('usersTableBody');
            tbody.innerHTML = '';
            
            Object.entries(allUsers).forEach(([username, user]) => {
                const row = document.createElement('tr');
                
                const roleClass = `role-${user.role}`;
                const statusClass = user.status === 'active' ? 'status-active' : 'status-inactive';
                
                row.innerHTML = `
                    <td>${username}</td>
                    <td><span class="${roleClass}">${getRoleName(user.role)}</span></td>
                    <td>${user.balance.toLocaleString()} –º–æ–Ω–µ—Ç</td>
                    <td>${(user.betLimit || settings.maxBetAmount).toLocaleString()} –º–æ–Ω–µ—Ç</td>
                    <td>${new Date(user.registeredAt).toLocaleDateString()}</td>
                    <td><span class="${statusClass}">${user.status === 'active' ? '–ê–∫—Ç–∏–≤–µ–Ω' : '–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω'}</span></td>
                    <td>
                        <button class="btn" style="padding: 6px 12px; font-size: 12px;" onclick="editUser('${username}')">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                        <button class="btn ${user.status === 'active' ? 'btn-warning' : 'btn-success'}" 
                                style="padding: 6px 12px; font-size: 12px;" 
                                onclick="toggleUserStatus('${username}')">
                            ${user.status === 'active' ? '–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å' : '–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å'}
                        </button>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
        }

        function getRoleName(role) {
            const roles = {
                'admin': '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä',
                'moderator': '–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä',
                'user': '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'
            };
            return roles[role] || role;
        }

        function filterUsers() {
            const roleFilter = document.getElementById('userRoleFilter').value;
            const searchFilter = document.getElementById('userSearchFilter').value.toLowerCase();
            
            const tbody = document.getElementById('usersTableBody');
            const rows = tbody.querySelectorAll('tr');
            
            rows.forEach(row => {
                const username = row.cells[0]?.textContent.toLowerCase() || '';
                const role = row.cells[1]?.textContent.toLowerCase() || '';
                
                const matchesRole = roleFilter === 'all' || role.includes(roleFilter);
                const matchesSearch = searchFilter === '' || username.includes(searchFilter);
                
                row.style.display = matchesRole && matchesSearch ? '' : 'none';
            });
        }

        function showAddUserModal() {
            document.getElementById('addUserModal').style.display = 'block';
        }

        function editUser(username) {
            const user = allUsers[username];
            if (!user) return;
            
            document.getElementById('editUserLogin').value = username;
            document.getElementById('editUserLoginDisplay').value = username;
            document.getElementById('editUserRole').value = user.role;
            document.getElementById('editUserBalance').value = user.balance;
            document.getElementById('editUserBetLimit').value = user.betLimit || settings.maxBetAmount;
            document.getElementById('editUserPassword').value = '';
            
            document.getElementById('editUserModal').style.display = 'block';
        }

        function addUser() {
            const login = document.getElementById('newUserLogin').value.trim();
            const password = document.getElementById('newUserPassword').value.trim();
            const role = document.getElementById('newUserRole').value;
            const balance = parseInt(document.getElementById('newUserBalance').value);
            
            if (!login || !password) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è');
                return;
            }
            
            if (allUsers[login]) {
                alert('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –ª–æ–≥–∏–Ω–æ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç');
                return;
            }
            
            allUsers[login] = {
                password: password,
                role: role,
                balance: balance,
                betLimit: settings.maxBetAmount,
                registeredAt: Date.now(),
                status: 'active'
            };
            
            displayUsers();
            closeModal('addUserModal');
            alert('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª–µ–Ω —É—Å–ø–µ—à–Ω–æ!');
        }

        function updateUser() {
            const username = document.getElementById('editUserLogin').value;
            const user = allUsers[username];
            if (!user) return;
            
            user.role = document.getElementById('editUserRole').value;
            user.balance = parseInt(document.getElementById('editUserBalance').value);
            user.betLimit = parseInt(document.getElementById('editUserBetLimit').value);
            
            const newPassword = document.getElementById('editUserPassword').value.trim();
            if (newPassword) {
                user.password = newPassword;
            }
            
            displayUsers();
            closeModal('editUserModal');
            alert('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω —É—Å–ø–µ—à–Ω–æ!');
        }

        function toggleUserStatus(username) {
            const user = allUsers[username];
            if (!user) return;
            
            user.status = user.status === 'active' ? 'inactive' : 'active';
            displayUsers();
            
            const action = user.status === 'active' ? '—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω' : '–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω';
            alert(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${username} ${action}`);
        }

        // ===== –£–ü–†–ê–í–õ–ï–ù–ò–ï –°–¢–ê–í–ö–ê–ú–ò =====
        async function loadBets() {
            try {
                const tbody = document.getElementById('betsTableBody');
                tbody.innerHTML = '<tr><td colspan="9" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞–≤–æ–∫...</td></tr>';
                
                // –°–∏–º—É–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —Å—Ç–∞–≤–æ–∫
                setTimeout(() => {
                    allBets = {
                        'bet1': {
                            user: 'user1',
                            type: 'single',
                            amount: 100,
                            coefficient: 2.5,
                            status: 'won',
                            timestamp: Date.now() - 2 * 60 * 60 * 1000,
                            events: [{eventId: 'event1', option: '–î–∞', coefficient: 2.5}]
                        },
                        'bet2': {
                            user: 'user1',
                            type: 'express',
                            amount: 50,
                            coefficient: 6.25,
                            status: 'lost',
                            timestamp: Date.now() - 5 * 60 * 60 * 1000,
                            events: [
                                {eventId: 'event1', option: '–î–∞', coefficient: 2.5},
                                {eventId: 'event2', option: '–ù–µ—Ç', coefficient: 2.5}
                            ]
                        },
                        'bet3': {
                            user: 'moderator1',
                            type: 'single',
                            amount: 200,
                            coefficient: 1.8,
                            status: 'pending',
                            timestamp: Date.now() - 30 * 60 * 1000,
                            events: [{eventId: 'event3', option: '–í–æ–∑–º–æ–∂–Ω–æ', coefficient: 1.8}]
                        }
                    };
                    
                    displayBets();
                }, 1000);
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞–≤–æ–∫:', error);
            }
        }

        function displayBets() {
            const tbody = document.getElementById('betsTableBody');
            tbody.innerHTML = '';
            
            Object.entries(allBets).forEach(([betId, bet]) => {
                const row = document.createElement('tr');
                
                const statusClass = `status-${bet.status}`;
                const potentialWin = (bet.amount * bet.coefficient).toFixed(2);
                
                row.innerHTML = `
                    <td>${betId}</td>
                    <td>${bet.user}</td>
                    <td>${bet.type === 'single' ? '–û–¥–∏–Ω–æ—á–Ω–∞—è' : '–≠–∫—Å–ø—Ä–µ—Å—Å'}</td>
                    <td>${bet.amount}</td>
                    <td>${bet.coefficient}</td>
                    <td>${potentialWin}</td>
                    <td><span class="${statusClass}">${getStatusName(bet.status)}</span></td>
                    <td>${new Date(bet.timestamp).toLocaleString()}</td>
                    <td>
                        <button class="btn" style="padding: 6px 12px; font-size: 12px;" onclick="viewBet('${betId}')">–ü—Ä–æ—Å–º–æ—Ç—Ä</button>
                        ${bet.status === 'pending' ? `<button class="btn btn-danger" style="padding: 6px 12px; font-size: 12px;" onclick="cancelBet('${betId}')">–û—Ç–º–µ–Ω–∏—Ç—å</button>` : ''}
                    </td>
                `;
                
                tbody.appendChild(row);
            });
        }

        function getStatusName(status) {
            const statuses = {
                'pending': '–û–∂–∏–¥–∞–µ—Ç',
                'won': '–í—ã–∏–≥—Ä–∞–ª–∞',
                'lost': '–ü—Ä–æ–∏–≥—Ä–∞–ª–∞'
            };
            return statuses[status] || status;
        }

        function filterBets() {
            const statusFilter = document.getElementById('betStatusFilter').value;
            const typeFilter = document.getElementById('betTypeFilter').value;
            const userFilter = document.getElementById('betUserFilter').value.toLowerCase();
            
            const tbody = document.getElementById('betsTableBody');
            const rows = tbody.querySelectorAll('tr');
            
            rows.forEach(row => {
                const status = row.cells[6]?.textContent.toLowerCase() || '';
                const type = row.cells[2]?.textContent.toLowerCase() || '';
                const user = row.cells[1]?.textContent.toLowerCase() || '';
                
                const matchesStatus = statusFilter === 'all' || status.includes(statusFilter);
                const matchesType = typeFilter === 'all' || type.includes(typeFilter);
                const matchesUser = userFilter === '' || user.includes(userFilter);
                
                row.style.display = matchesStatus && matchesType && matchesUser ? '' : 'none';
            });
        }

        function viewBet(betId) {
            const bet = allBets[betId];
            if (!bet) return;
            
            const details = document.getElementById('betDetails');
            details.innerHTML = `
                <div class="admin-card">
                    <p><strong>ID —Å—Ç–∞–≤–∫–∏:</strong> ${betId}</p>
                    <p><strong>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:</strong> ${bet.user}</p>
                    <p><strong>–¢–∏–ø:</strong> ${bet.type === 'single' ? '–û–¥–∏–Ω–æ—á–Ω–∞—è' : '–≠–∫—Å–ø—Ä–µ—Å—Å'}</p>
                    <p><strong>–°—É–º–º–∞:</strong> ${bet.amount} –º–æ–Ω–µ—Ç</p>
                    <p><strong>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç:</strong> ${bet.coefficient}</p>
                    <p><strong>–í–æ–∑–º–æ–∂–Ω—ã–π –≤—ã–∏–≥—Ä—ã—à:</strong> ${(bet.amount * bet.coefficient).toFixed(2)} –º–æ–Ω–µ—Ç</p>
                    <p><strong>–°—Ç–∞—Ç—É—Å:</strong> ${getStatusName(bet.status)}</p>
                    <p><strong>–î–∞—Ç–∞:</strong> ${new Date(bet.timestamp).toLocaleString()}</p>
                    
                    <h4 style="margin-top: 20px; margin-bottom: 10px;">–°–æ–±—ã—Ç–∏—è:</h4>
                    ${bet.events.map(event => `
                        <div style="background: rgba(255,255,255,0.1); padding: 10px; margin: 5px 0; border-radius: 8px;">
                            <strong>–°–æ–±—ã—Ç–∏–µ:</strong> ${event.eventId}<br>
                            <strong>–í—ã–±–æ—Ä:</strong> ${event.option}<br>
                            <strong>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç:</strong> ${event.coefficient}
                        </div>
                    `).join('')}
                </div>
            `;
            
            document.getElementById('viewBetModal').style.display = 'block';
        }

        function cancelBet(betId) {
            if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—Ç–º–µ–Ω–∏—Ç—å —ç—Ç—É —Å—Ç–∞–≤–∫—É?')) {
                return;
            }
            
            const bet = allBets[betId];
            if (bet && bet.status === 'pending') {
                bet.status = 'cancelled';
                
                // –í–æ–∑–≤—Ä–∞—Ç —Å—Ä–µ–¥—Å—Ç–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
                if (allUsers[bet.user]) {
                    allUsers[bet.user].balance += bet.amount;
                }
                
                displayBets();
                alert('–°—Ç–∞–≤–∫–∞ –æ—Ç–º–µ–Ω–µ–Ω–∞, —Å—Ä–µ–¥—Å—Ç–≤–∞ –≤–æ–∑–≤—Ä–∞—â–µ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é');
            }
        }

        // ===== –ù–ê–°–¢–†–û–ô–ö–ò =====
        function loadSettings() {
            document.getElementById('maxBetAmount').value = settings.maxBetAmount;
            document.getElementById('defaultBalance').value = settings.defaultBalance;
            document.getElementById('minBetAmount').value = settings.minBetAmount;
            document.getElementById('maxCoefficient').value = settings.maxCoefficient;
            document.getElementById('winCommission').value = settings.winCommission;
            document.getElementById('minWithdraw').value = settings.minWithdraw;
            document.getElementById('maxWithdrawPerDay').value = settings.maxWithdrawPerDay;
            document.getElementById('maintenanceMode').checked = settings.maintenanceMode;
            document.getElementById('maintenanceMessage').value = settings.maintenanceMessage;
        }

        function saveSettings() {
            settings.maxBetAmount = parseInt(document.getElementById('maxBetAmount').value);
            settings.defaultBalance = parseInt(document.getElementById('defaultBalance').value);
            settings.minBetAmount = parseInt(document.getElementById('minBetAmount').value);
            settings.maxCoefficient = parseFloat(document.getElementById('maxCoefficient').value);
            
            alert('–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!');
        }

        function saveCommissionSettings() {
            settings.winCommission = parseFloat(document.getElementById('winCommission').value);
            settings.minWithdraw = parseInt(document.getElementById('minWithdraw').value);
            settings.maxWithdrawPerDay = parseInt(document.getElementById('maxWithdrawPerDay').value);
            
            alert('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–º–∏—Å—Å–∏–π —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!');
        }

        function toggleMaintenance() {
            settings.maintenanceMode = document.getElementById('maintenanceMode').checked;
            settings.maintenanceMessage = document.getElementById('maintenanceMessage').value;
            
            const status = settings.maintenanceMode ? '–≤–∫–ª—é—á–µ–Ω' : '–≤—ã–∫–ª—é—á–µ–Ω';
            alert(`–†–µ–∂–∏–º —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è ${status}!`);
        }

        function exportData() {
            const data = {
                users: allUsers,
                bets: allBets,
                events: allEvents,
                settings: settings,
                exportDate: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `maxbet_backup_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function cleanOldBets() {
            if (!confirm('–£–¥–∞–ª–∏—Ç—å —Å—Ç–∞–≤–∫–∏ —Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π?')) return;
            
            const thirtyDaysAgo = Date.now() - 30 * 24 * 60 * 60 * 1000;
            let deletedCount = 0;
            
            Object.entries(allBets).forEach(([betId, bet]) => {
                if (bet.timestamp < thirtyDaysAgo && bet.status !== 'pending') {
                    delete allBets[betId];
                    deletedCount++;
                }
            });
            
            alert(`–£–¥–∞–ª–µ–Ω–æ ${deletedCount} —Å—Ç–∞—Ä—ã—Ö —Å—Ç–∞–≤–æ–∫`);
            if (currentTab === 'bets') displayBets();
        }

        function resetAllBalances() {
            if (!confirm('–°–±—Ä–æ—Å–∏—Ç—å –±–∞–ª–∞–Ω—Å—ã –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–æ —Å—Ç–∞—Ä—Ç–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ!')) {
                return;
            }
            
            Object.values(allUsers).forEach(user => {
                user.balance = settings.defaultBalance;
            });
            
            alert('–ë–∞–ª–∞–Ω—Å—ã –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–±—Ä–æ—à–µ–Ω—ã!');
            if (currentTab === 'users') displayUsers();
        }

        // ===== –°–¢–ê–¢–ò–°–¢–ò–ö–ê =====
        function loadStatistics() {
            // –ü–æ–¥—Å—á–µ—Ç –æ–±—â–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            const totalUsers = Object.keys(allUsers).length;
            const totalBets = Object.keys(allBets).length;
            const totalVolume = Object.values(allBets).reduce((sum, bet) => sum + bet.amount, 0);
            const activeEvents = Object.values(allEvents).filter(event => event.status === 'active').length;
            const totalBalance = Object.values(allUsers).reduce((sum, user) => sum + user.balance, 0);
            const pendingBets = Object.values(allBets).filter(bet => bet.status === 'pending').length;
            
            document.getElementById('totalUsers').textContent = totalUsers;
            document.getElementById('totalBets').textContent = totalBets;
            document.getElementById('totalVolume').textContent = totalVolume.toLocaleString();
            document.getElementById('activeEvents').textContent = activeEvents;
            document.getElementById('totalBalance').textContent = totalBalance.toLocaleString();
            document.getElementById('pendingBets').textContent = pendingBets;
            
            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
            const categoryStats = {};
            Object.values(allEvents).forEach(event => {
                if (!categoryStats[event.category]) {
                    categoryStats[event.category] = { count: 0, bets: 0 };
                }
                categoryStats[event.category].count++;
            });
            
            const categoryStatsDiv = document.getElementById('categoryStats');
            categoryStatsDiv.innerHTML = Object.entries(categoryStats).map(([category, stats]) => `
                <div style="margin-bottom: 10px; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px;">
                    <strong>${getCategoryName(category)}</strong><br>
                    –°–æ–±—ã—Ç–∏—è: ${stats.count} | –°—Ç–∞–≤–∫–∏: ${stats.bets}
                </div>
            `).join('');
            
            // –¢–æ–ø –∏–≥—Ä–æ–∫–∏
            const topPlayers = Object.entries(allUsers)
                .map(([username, user]) => ({
                    username,
                    volume: Object.values(allBets)
                        .filter(bet => bet.user === username)
                        .reduce((sum, bet) => sum + bet.amount, 0)
                }))
                .sort((a, b) => b.volume - a.volume)
                .slice(0, 5);
            
            const topPlayersDiv = document.getElementById('topPlayers');
            topPlayersDiv.innerHTML = topPlayers.map((player, index) => `
                <div style="margin-bottom: 10px; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px;">
                    <strong>${index + 1}. ${player.username}</strong><br>
                    –û–±–æ—Ä–æ—Ç: ${player.volume.toLocaleString()} –º–æ–Ω–µ—Ç
                </div>
            `).join('');
        }

        function getCategoryName(category) {
            const categories = {
                'politics': 'üèõÔ∏è –ü–æ–ª–∏—Ç–∏–∫–∞',
                'entertainment': 'üé≠ –†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è',
                'technology': 'üíª –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏',
                'economics': 'üí∞ –≠–∫–æ–Ω–æ–º–∏–∫–∞',
                'weather': 'üå§Ô∏è –ü–æ–≥–æ–¥–∞',
                'society': 'üë• –û–±—â–µ—Å—Ç–≤–æ'
            };
            return categories[category] || category;
        }

        // ===== –°–û–ë–´–¢–ò–Ø (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏) =====
        function addEvent() {
            alert('–§—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏—è (–∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å –æ—Å–Ω–æ–≤–Ω—ã–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º)');
        }

        function loadAdminEvents() {
            // –°–∏–º—É–ª—è—Ü–∏—è —Å–æ–±—ã—Ç–∏–π
            allEvents = {
                'event1': {
                    title: '–í—ã–±–æ—Ä—ã –ø—Ä–µ–∑–∏–¥–µ–Ω—Ç–∞ –°–®–ê 2028',
                    category: 'politics',
                    status: 'active',
                    createdBy: 'admin',
                    timestamp: Date.now()
                },
                'event2': {
                    title: '–ö—É—Ä—Å Bitcoin –¥–æ—Å—Ç–∏–≥–Ω–µ—Ç $100,000',
                    category: 'economics',
                    status: 'active',
                    createdBy: 'moderator1',
                    timestamp: Date.now() - 60 * 60 * 1000
                }
            };
            
            const container = document.getElementById('adminEventsList');
            container.innerHTML = Object.entries(allEvents).map(([eventId, event]) => `
                <div style="background: rgba(255,255,255,0.1); padding: 15px; margin: 10px 0; border-radius: 8px;">
                    <strong>${event.title}</strong><br>
                    <small>–ö–∞—Ç–µ–≥–æ—Ä–∏—è: ${getCategoryName(event.category)} | –°—Ç–∞—Ç—É—Å: ${event.status}</small><br>
                    <button class="btn" style="padding: 6px 12px; font-size: 12px; margin-top: 10px;">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                    <button class="btn btn-warning" style="padding: 6px 12px; font-size: 12px;">–ó–∞–≤–µ—Ä—à–∏—Ç—å</button>
                </div>
            `).join('');
        }

        function loadUnfinishedEvents() {
            alert('–ü–æ–∏—Å–∫ –Ω–µ–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π...');
        }

        function fixEventsCategories() {
            alert('–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Å–æ–±—ã—Ç–∏–π...');
        }

        // ===== –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê =====
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –∏—Ö
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        };

        // ===== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø =====
        window.addEventListener('load', function() {
            // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–≤–æ–π –≤–∫–ª–∞–¥–∫–∏
            loadAdminEvents();
        });
    </script>
</body>
</html>
